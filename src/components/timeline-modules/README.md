# 时间轴模块化架构

这个目录包含了 TimelinePixi.vue 组件的模块化绘制逻辑，将原本的单一文件拆分成多个独立的功能模块。

## 模块结构

### 1. `config.js` - 配置模块

- 管理时间轴的基本配置参数
- 定义朝代数据和颜色映射
- 提供配置更新方法

### 2. `utils.js` - 工具函数模块

- 提供通用的计算和工具函数
- 年份位置计算
- 颜色获取
- 文本样式创建
- 数值限制和缓动函数

### 3. `data-processor.js` - 数据处理模块

- 处理和整合各种时间轴数据
- 合并帝皇数据
- 诗人数据排序和过滤
- 搜索功能支持

### 4. `timeline-renderer.js` - 时间轴绘制模块

- 负责绘制主时间轴
- 绘制年份刻度和标签
- 时间轴基础结构

### 5. `dynasty-renderer.js` - 朝代绘制模块

- 绘制朝代背景区域
- 朝代标签显示
- 朝代可见性控制

### 6. `emperor-renderer.js` - 帝皇绘制模块

- 绘制帝皇时间块
- 帝皇悬停提示功能
- 帝皇交互处理

### 7. `poet-renderer.js` - 诗人绘制模块

- 绘制诗人时间条
- 诗人位置计算
- 诗人交互处理

### 8. `interaction-controller.js` - 交互控制模块

- 管理用户交互功能
- 拖拽和缩放控制
- 视图重置和动画
- 导航到指定诗人

### 9. `index.js` - 模块入口

- 统一导出所有模块的公共接口
- 简化主组件的导入

## 使用方式

在主组件中，只需要从入口文件导入所需的功能：

```javascript
import {
  timelineConfig,
  getAllEmperors,
  drawTimeline,
  drawDynasties,
  drawEmperors,
  drawPoets,
  setupInteractions,
  centerView,
  // ... 其他需要的功能
} from "./timeline-modules/index.js";
```

## 模块化的优势

1. **代码组织清晰** - 每个模块负责特定的功能，职责明确
2. **易于维护** - 修改某个功能时只需要关注对应的模块
3. **可复用性强** - 各个模块可以独立使用或在其他项目中复用
4. **测试友好** - 每个模块可以独立进行单元测试
5. **扩展性好** - 新增功能时可以创建新模块，不影响现有代码
6. **性能优化** - 可以按需加载模块，减少初始加载时间

## 扩展指南

如果需要添加新功能，建议：

1. 创建新的模块文件，遵循现有的命名规范
2. 在 `index.js` 中导出新模块的公共接口
3. 在主组件中导入并使用新功能
4. 更新此 README 文件，说明新模块的用途

## 注意事项

- 所有模块都使用 ES6 模块语法
- 保持模块间的低耦合，避免循环依赖
- 公共配置和常量统一在 `config.js` 中管理
- 工具函数尽量保持纯函数特性，便于测试和复用
